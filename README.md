# grecha

"Крупье" - программно-аппаратный комплекс автоматизации оценки качества и учёта поступающего сырья от поставщиков.

### Реализованная функциональность
 - приложение симуляции cctv камер с помощью телефонов
 - отправка изображений на сервер для анализа
 - модуль оценки качества сырья (греча\перец) с помощью комьютерного зрения
 - распознавание номеров вагонов с помощью компьютерного зрения
 - сохранение истории оценки качества сырья, исходных изображений
 - визуалиазция процесса в реальном времени для возможности оценки ситуации на площадке с уведомлениями о проблемах с сырьём
 - визуализация аналитки в разрезе производственного цикла, в разрезе поставщиков, в разрезе отдельных вагонов

### Особенности проекта
 - кросплатформенный код, который возможно запускать на различных edge-устройствах в зависимости от требований к процессам (x86-64, ARM)
 - возможность запуска анализа изображений на Jetson Nano, Raspberry Pi, x86 мини-pc
 - использование OpenCV на всех стадиях работы с изображениями, что даёт возможность выполнения кода на спецализированных ядрах Jetson Nano или видеокартах
 - настраиваемые пороги срабатывания
 - минимизация траффика от edge-устройства - использование протокола MessagePack
 - накомпление необработанных изображений на самом устройстве с возможность их забора по-требованиюс АРМ инженера ОТК, или в фоне
 - лёгкая масштабируемость и ввод в экплуатацию конечных комплексов (мини-pc + камеры + модем)
 - возможность обновления ПО в edge-устройствах по воздуху, например для загрузки новых уточнённых моделей оценки качества сырья
 - толстый клиент для планшетов дающий инженерам ОТК перемещаться по производству не теряя контроля над процессом разгрузки (не реализовано)
 
### Основной стек технологий:

 - .NET 6.0
 - OpenCV + Tesseract
 - Xamarin
 - Entity Framework Core 6.0
 - Postgres 13
 - React, SignalR, MessagePack

## Демо
Демо проекта доступно по адресу: http://atomspeech.germanywestcentral.cloudapp.azure.com

### Среда запуска
1. Развёртывание сервиса производится в любой linux системе поддерживаемой .net 6.0 или в любой современной версии Windows. Запускать можно как в docker-контейнере так и нативно.
2. Требуется установленный .NET 6.0
3. Требутеся установленная СУБД Postgres версии 10 и выше

### Установка
1. Docker: Запустить контейнер, прописать в ENV переменную ConnectionStrings:DashDBContext строку подключения к бд (например `Server=atomspeech.germanywestcentral.cloudapp.azure.com;User Id=postgres;Password=my_secret_pa$$w0rd;Database=grecha`)

2. Как сервис:

2.1 Установить .NET 6.0 для вашей ОС (https://dotnet.microsoft.com/download/dotnet/6.0/runtime)

2.2 зарегистрировать исполняемый файл как сервис в вашей ОС. В файл appsettings.Production.json прописать настройку ConnectionStrings.GrechaDBContext строку подключения к БД.

### База данных
1. Установить Postgresql для вашей ОС (https://www.postgresql.org/download/)
2. Создать базу данных

### Выполнение миграций
Миграции на актуальную версию схемы базы автоматически выполняются при запуске приложения.

### Разработчики
Мусалямов Ильдар :: backend :: https://github.com/caxepok

Гурьянов Александр :: frontend :: https://github.com/graverok